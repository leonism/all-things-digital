import{r as a,a as E,_,i as z,o as B,c as p,b as d,e as C,f as M,O as S,n as T,d as c,B as I,m as N,P as R,L as $}from"./main-i9f7EwPm.js";import{_ as j}from"./blog-data-CLJAN-Oi.js";function P(i={}){const{rootMargin:w="50px",threshold:e=.1,loadDelay:f=0,retryAttempts:k=3,retryDelay:v=1e3}=i,o=a(!1),s=a(!1),y=a(!1),g=a(!1),n=a(0),h=a(null);let u=null,b=null;const m=async l=>{if(!(y.value||s.value)){s.value=!0,g.value=!1,n.value++;try{f>0&&await new Promise(t=>setTimeout(t,f)),l&&await l(),y.value=!0,s.value=!1}catch(t){console.error("Lazy loading error:",t),s.value=!1,g.value=!0,n.value<k&&(b=setTimeout(()=>{m(l)},v*n.value))}}},x=l=>{n.value=0,g.value=!1,m(l)},L=l=>{h.value&&(u=new IntersectionObserver(t=>{t.forEach(r=>{r.isIntersecting&&!o.value&&(o.value=!0,m(l),u.unobserve(r.target))})},{rootMargin:w,threshold:e}),u.observe(h.value))};return E(()=>{u&&u.disconnect(),b&&clearTimeout(b)}),{targetRef:h,isVisible:o,isLoading:s,isLoaded:y,hasError:g,loadAttempts:n,observe:L,load:m,retry:x}}const V={key:0,class:"animate-pulse bg-gray-300 dark:bg-gray-700 w-full h-full rounded"},A={key:1,class:"flex items-center justify-center w-full h-full"},O={key:2,class:"flex items-center justify-center w-full h-full bg-gray-100 dark:bg-gray-800"},q={__name:"LazyOptimizedPicture",props:{src:{type:String,required:!0},alt:{type:String,required:!0},width:{type:[String,Number],default:null},height:{type:[String,Number],default:null},sizes:{type:String,default:"100vw"},imgClass:{type:String,default:""},placeholderClass:{type:String,default:""},loadingType:{type:String,default:"skeleton",validator:i=>["skeleton","spinner","placeholder"].includes(i)},eager:{type:Boolean,default:!1},rootMargin:{type:String,default:"50px"},threshold:{type:Number,default:.1}},emits:["load","error","visible"],setup(i,{emit:w}){const e=i,f=w,k=a(null),v=a(!1),o=a(!1),s=a(e.eager),y=z(()=>e.loadingType==="skeleton"),g=z(()=>e.loadingType==="spinner"),n=z(()=>e.width&&e.height?`${e.width} / ${e.height}`:"auto"),{targetRef:h,observe:u}=P({rootMargin:e.rootMargin,threshold:e.threshold}),b=()=>{v.value=!0,f("load")},m=()=>{o.value=!0,f("error")},x=t=>{t.style.opacity="0"},L=t=>{t.style.opacity="1"},l=()=>{o.value=!1,v.value=!1,s.value=!0};return B(()=>{h.value=k.value,e.eager||u(()=>{s.value=!0,f("visible")})}),(t,r)=>(d(),p("div",{ref_key:"imageContainer",ref:k,class:"lazy-image-container h-full"},[!v.value&&!o.value?(d(),p("div",{key:0,class:T(["image-placeholder",i.placeholderClass]),style:S({aspectRatio:n.value})},[y.value?(d(),p("div",V)):g.value?(d(),p("div",A,r[0]||(r[0]=[c("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500"},null,-1)]))):(d(),p("div",O,r[1]||(r[1]=[c("svg",{class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])))],6)):o.value?(d(),p("div",{key:1,class:"error-placeholder flex flex-col items-center justify-center p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded",style:S({aspectRatio:n.value})},[r[2]||(r[2]=c("svg",{class:"w-8 h-8 text-red-500 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),r[3]||(r[3]=c("p",{class:"text-sm text-red-600 dark:text-red-400 text-center mb-2"},"Failed to load image",-1)),c("button",{onClick:l,class:"text-xs px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition-colors"}," Retry ")],4)):C("",!0),M($,{name:"fade",onEnter:x,onAfterEnter:L},{default:I(()=>[s.value&&!o.value?(d(),N(j,R({key:0},t.$props,{"img-class":`${i.imgClass} transition-opacity duration-300 ${v.value?"opacity-100":"opacity-0"}`,onLoad:b,onError:m}),null,16,["img-class"])):C("",!0)]),_:1})],512))}},U=_(q,[["__scopeId","data-v-5129d409"]]);export{U as L};
